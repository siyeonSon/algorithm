-- 2023-02-24 20:00:06
-- https://school.programmers.co.kr/learn/courses/30/lessons/131117

SELECT B.PRODUCT_ID, B.PRODUCT_NAME, SUM(A.AMOUNT * B.PRICE) AS TOTAL_SALES 
FROM FOOD_ORDER A
JOIN FOOD_PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID
WHERE A.PRODUCE_DATE BETWEEN DATE('2022-05-01') AND DATE('2022-05-31')
GROUP BY B.PRODUCT_ID
ORDER BY TOTAL_SALES DESC, B.PRODUCT_ID